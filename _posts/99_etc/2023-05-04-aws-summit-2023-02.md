---
layout: post
title : AWS Summit 2023 Day.2
date  : 2023-05-04
image : aws-summit-2023-01-00.jpg
tags  : AWS aws awssummit awssummit2023
---

## Session. Key Note: 세상은 `비동기 + 이벤트` 기반이다.

인간의 생활 속은 이미 **비동기** 기반의 **이벤트** 연속이다. 동기 기반의 삶이라면, 아마도 다른 버티지 못할 것이다.

`MSA` 라는 시스템 아키텍처를 처음 제안한 `AWS` 의 많은 아키텍처 개발자들은 `MSA` 기반의 시스템 아키텍처를 넘어 **이벤트 기반 아키텍처**로 변화해야 한다고 한다.
더이상 하나의 서버 시스템에 묶여 확장성과 변경에 대한 두려움에서 벗어나야 한다는 것이다.

그러기 위해, 제안하는 것인 **`Sever-less` 서버리스** 기반의 시스템 아키텍처이며,
**서버리스** 서비스를 활용한다면, **이벤트 기반 아키텍처** 구성이 가능하다고 한다.

### `Sever-less` 서버리스 서비스

**서버리스** 서비스는 아래와 같은 장점을 제공한다.

- 시스템 통합 용이
- 시스템 구축 시간 단축
- 점진적인 `PoC (Proof of Concept)`를 통해 클라우드 전환 가능

`AWS` 에서는 이런 서버리스 서비스를 `AWS Lambda` 를 포함한 클라우드 컴퓨팅 뿐만 아니라 DB, 스토리지 서비스도 제공하고 있다.

#### 서버리스 이벤트 기반 아키텍처 장점

- 세계화 글로벌 시대에 맞춰 서비스를 제공하기 위해서는 온프레미스의 단점은 너무 크다.
    - 네트워크 단절, 제한적인 리소스, 낮은 확장성
- 다양한 정보와 이벤트에 맞춰 유연하고 확장 가능한 클라우드와 서버리스 기반 아키텍처가 필요하다.
    - 세계 각지에 있는 사용자 위치에 따른 데이터 저장, 조회, 처리를 `AWS` 클라우드로 해결한 **Flitto**

##### `3-Tier` 아키텍처에서 벗어나 ✨이벤트 기반 아키텍처✨ 로 전환이 필요한 시점이다.

----

## Session. 오픈소스 데이터베이스로 탈 오라클! Why not?

클라우드 네이티브가 서비스의 강점이 되어가고 있지만, 온프레미스 시스템에서 클라우드로 전환할 때 제일 큰 문제 중 하나는 바로 **데이터베이스 마이그레이션** 이다.
(`Oracle` 과 같은 데이터베이스를 벗어나기란 쉽지 않은 건 사실이다.)

하지만, `Monolithic` 모놀리식 아키텍처에서 `MSA` 아키텍처로 변해간 것 처럼,
다양한 비즈니스 도메인에 대한 데이터가 점점 방대해져가고, 서로 다른 데이터 형식과 저장/가공 방식이 필요한 이상, `RDBMS` 로만 서비스를 운영한다면 경쟁력이 떨어질 것이다.

그렇다면, 온프레이스 기반의 `RDBMS` 를 벗어나 완전 관리형 클라우드로 전환하는 것이 제일 좋겠지만,
그게 힘들다면 오픈소스 기반 `DBMS` 로 전환 또는 다양한 형식의 데이터를 다르게 저장하고 처리할 수 있도록 **다중 DB** 저장 처리 방식으로 전환이 필요할 것 같다.

![데이터 현대화 아키텍처](/images/aws-summit-2023-01-09.jpg)

### SKT 의 탈 오라클 과정

**SKT** 에서도 클라우드 전환을 위한 단계 중 제일 큰 문제는 **오라클DB** 를 벗어나 **목적 지향 데이터베이스로 전환하는 것**이었다고 한다.

![목적 지향 데이터베이스 전환 과정](/images/aws-summit-2023-01-10.jpg)

**탈 오라클** 을 위한 단계는 다음과 같다.

1. 설계
    - 요구사항과 현재 시스템의 특성을 충족하는 오픈소스 DB 분류
    - 충분한 성능 테스트 과정을 거쳐 DB 선택
2. 개발
    - `SQL` 가이드 문서를 공통적으로 작성하고 개발자들에게 가이드하여 장애 이슈 최소화
3. 데이터 이전
    - `AWS DMS` 서비스를 이용하여 DB 마이그레이션 진행
    - `Source DB` 와 `Target DB` 의 데이터 타입 등 처리 방식에 대한 차이는 `DB Link` 를 활용하여 차이를 최소화
    - 👍 `Oracle > DB Link > 중계 서버 > DMS > Aurora DB`
4. 운영 최적화
    - 새로운 DB 의 성능 테스트를 통해 DB CPU 선택 등 DB 환경 구성 변경
    - `Aurora 오로라 DB` 선택한 **SKT** 는 **Graviton CPU** 권장
    - 초기에는 비용적인 이슈가 있어보일 수 있지만, 최적화를 통해 많은 비용 절약
    
![오픈소스 DB 비용 차이](/images/aws-summit-2023-01-11.jpg)

----

## Session. Amazon Neptune 및 Elastic 을 이용한 추천 서비스 및 검색 플랫폼 구축하기

### Neptune 추천 서비스 구축 <small>메디스트림(인티그레이션)</small>

한의원의 다양한 의료 서비스를 지원하고 있는 **메디스트림** 서비스도 **키워드 기반 추천 서비스** 기능을 제공해주기 위해
`Graph` 기반 완전 관리형 데이터베이스는 `Neptune` 를 선택한 이유 중 하나가 비정형 데이터 처리하기 위함이라고 한다.

추천 서비스 기능에 대한 요건은 **하나의 키워드**를 검색하였을 때, 자료 & 영상 & 서적 & 의료 기기 등 성격이 다양한 정보를 제공하는 것이었다.
각 정보들은 서로 다른 성격이지만, 같은 **키워드**로 연결 관계를 가진 상태 저장되는 구조를 설계해야 한다.

**하나의 키워드**에 대한 그래프 형식으로 다양한 데이터를 연결하는 구조로 그래프 데이터베이스를 구축하는 과정은 아죽 복잡하고,
`NLP`, `ETL` 와 같은 자연어 처리 등 많은 작업 소요 시간이 필요하여 결코 행복하지않은(?) 작업이었다고 한다.

### EKS 에서 Elastic 이용한 검색 플랫폼 구축

**무신사**와 같은 검색 기능이 많은 서비스는 검색 플랫폼 자체를 모듈화하고, 필요한 서비스에 인프라 연동하는 방식을 사용하고 있었다.

**무신사**의 검색 플랫폼의 변화는,

1. 온프레미스 `ES` 직접 구축하고 운영
2. 온프레미스 `ES` 모듈화하고 각 서비스별 클러스터를 구성하여 검색 인프라를 제공
3. (최종) `k8s` 기반의 `ECK Elastic Cloud` 환경을 구축하고, 클라우드 `ES` 클러스터 인프라 제공 자동화

#### ECK Elastic Cloud on Kubernetes

- Elastic operator 를 제공하는 서비스로 ES 와 Kibana 를 설치/연결 등 제어하는 역할
- 스케일링 제어도 설정 파일 수정으로 가능
- Load Balances 를 통해서 ECK 로 만들어진 ES 클러스터 접근을 제어

#### RBAC Role Based Access Control
- k8s 사용자와 IAM 사용자를 1:1 매핑하여 특정 namespace 의 리소스를 제어할 수 있도록 환경 구축

#### ECK 전환 그 이후,

##### 장점
- 간결한 배포
- 빠르고 우연한 확장과 축소
- k8s 생태계 활용

##### 단점
- k8s 운영 부담

----

### [AWS Summit 2023 공식 페이지](https://aws.amazon.com/ko/blogs/korea/aws-summit-seoul-2023-why-to-join/)